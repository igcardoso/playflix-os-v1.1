<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!-- FAVICON -->
  <link rel="shortcut icon" type="image/jpg" href="./assets/favicon.png" />

  <!-- GOOGLE FONTS -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <!-- *currently set to "Roboto". Feel free to change it to whatever you like* -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- CSS STYLE LINK -->
  <link rel="stylesheet" href="./styles/global.css" />
  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
  <link rel="manifest" href="manifest.json">
  <!-- ios support -->
  <link rel="apple-touch-icon" href="images/icons/icon-72x72.png">
  <link rel="apple-touch-icon" href="images/icons/icon-96x96.png">
  <link rel="apple-touch-icon" href="images/icons/icon-128x128.png">
  <link rel="apple-touch-icon" href="images/icons/icon-144x144.png">
  <link rel="apple-touch-icon" href="images/icons/icon-152x152.png">
  <link rel="apple-touch-icon" href="images/icons/icon-192x192.png">
  <link rel="apple-touch-icon" href="images/icons/icon-384x384.png">
  <link rel="apple-touch-icon" href="images/icons/icon-512x512.png">
  <meta name="apple-mobile-web-app-status-bar" content="#0c11ff">
  <meta name="theme-color" content="#0c11ff">
  <title>Playflix OS</title>
</head>
<body>
  <!-- popup de atualização -->
  <div id="update">
    <div class="marcador">
      <div></div>
      <div></div>
    </div>
    <button id="start_update">Atualizar</button>
    <p>
      Atualização obrigatória para correção de bugs na exibição. Ao atualizar está mensagem não tornará a aparecer até que uma nova atualização seja requisitada.
    </p>
    <svg style="enable-background:new 0 0 32 32;" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M29.9,17.5C29.7,17.2,29.4,17,29,17c-2.2,0-4.3,1-5.6,2.8L22.5,21c-1.1,1.3-2.8,2-4.5,2h-3c-0.6,0-1-0.4-1-1s0.4-1,1-1h1.9  c1.6,0,3.1-1.3,3.1-2.9c0,0,0-0.1,0-0.1c0-0.5-0.5-1-1-1l-6.1,0c-3.6,0-6.5,1.6-8.1,4.2l-2.7,4.2c-0.2,0.3-0.2,0.7,0,1l3,5  c0.1,0.2,0.4,0.4,0.6,0.5c0.1,0,0.1,0,0.2,0c0.2,0,0.4-0.1,0.6-0.2c3.8-2.5,8.2-3.8,12.7-3.8c3.3,0,6.3-1.8,7.9-4.7l2.7-4.8  C30,18.2,30,17.8,29.9,17.5z" /><path d="M4.5,18c0.1,0,0.3,0,0.4,0c1.2-1.1,2.7-1.9,4.3-2.4C9.1,15.1,9,14.5,9,14c0-4.4,3.6-8,8-8s8,3.6,8,8c0,0.7-0.1,1.4-0.3,2.1  C26,15.4,27.5,15,29,15c0.7,0,1.4,0.3,1.9,0.7C31,15.1,31,14.6,31,14c0-1.1-0.1-2.2-0.4-3.3c-0.1-0.5-0.6-0.8-1.1-0.8  c-1.2,0.2-2.4-0.4-3-1.5c-0.6-1-0.5-2.4,0.2-3.3c0.3-0.4,0.3-1-0.1-1.3C25,2.3,23.1,1.2,21,0.6c-0.5-0.1-1,0.1-1.2,0.6  C19.3,2.3,18.2,3,17,3s-2.3-0.7-2.8-1.8C14,0.7,13.5,0.4,13,0.6C10.9,1.2,9,2.3,7.4,3.9C7,4.2,7,4.8,7.3,5.2c0.7,1,0.8,2.3,0.2,3.3  c-0.6,1-1.8,1.6-3,1.5c-0.5-0.1-1,0.3-1.1,0.8C3.1,11.8,3,12.9,3,14s0.1,2.2,0.4,3.3C3.5,17.8,4,18.1,4.5,18z" /></svg>
  </div>
  <div id="loading">
    <div class="loading">
      <div class="point">

      </div>
    </div>
    <div id="labelNameUi">
      Fine UI
    </div>
  </div>
  <div id="select__player">
    <i id="backPageSelect" class='bx bx-chevron-left'></i>
    <div id="select1">
      <i class="bx bx-play"></i> Player 1
    </div>
    <div id="select2">
      <i class="bx bx-play"></i> Player 2
    </div>
  </div>
  <div id="pageFilm">
    <i id="backPageFilm" class='bx bx-chevron-left'></i>
    <div id="locationMovies">
      <div id="ads_protection">
        <i id="ads_protectionBx" class="bx bx-lock-alt"></i>
      </div>
      <iframe id="iframe" src="" width="100%" allowfullscreen="allowfullscreen" allow='autoplay' frameborder="0"></iframe>
    </div>
    <div class="orientation_alert">
      <p>
        Ao dar play você será redirecionado para um anúncio, basta voltar uma vez, e o player já estará disponível.
      </p>
      <video class="orientation_video" src="assets/how_to_give_play.mp4" width="90%" preload="preload" loop="loop" controls="0"></video>
      <div class="marker_contention">
        <span class="back"><i class="bx bx-x"></i></span>
      </div>
    </div>
  </div>
  <div id="app">
    <div class="app__image">
      <img
      loading="lazy"
      alt="Imagem do filme destaque"
      src=""
      />
    </div>

    <header id="header">
      <img style="border-radius: 8em;" id="imageUser" width="50px" height="50px" class="logo" src="images/icons/icon-512x512.png" alt="logo do app" />
      <span type="button" class="button__menu">
        <span></span>
        <span></span>
        <span></span>
      </span>

      <nav id="navigation" class="navigation">
        <h2 id="hello">Filmes</h2>
        <form class="form" id="add__movie">
          <input type="text" placeholder="Adicione o seu filme" name="movie" />
          <button type="submit">
            +
          </button>
        </form>
        <div class="type_entertainment">
          <span id="filmes" class="f">Filmes</span>
          <span id="channels" class="s">Canais</span>
        </div>
        <ul id="movies">

        </ul>
      </nav>
    </header>

    <main id="main">
      <section class="feature__movie">
        <div class="rating">
          <img width="30px" src="assets/logo-imdb.png">
          <strong></strong>
        </div>

        <!-- DATA DE LANÇAMENTO, CATEGORIA -->
        <span></span>
        <!-- TITULO DO FILME -->
        <h1></h1>
        <!-- SINOPSE DO FILME -->
        <p></p>

        <span class="playFilm">
          <i style="font-size: 20px;" class="bx bx-play"></i>
          Assistir agora
        </span>
      </section>
    </main>
  </div>
  <section id="settings">
    <span style="padding: 15px; margin: 20px; border-radius: var(--border-radius); background: var(--light);">
      <svg style="margin-bottom: -9px; transform: rotate(180deg);" id="back_from_settings" height="24" viewBox="0 0 18 18" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg> 
      &nbsp;
      Voltar
    </span>
    <!-- título da página -->
    <div class="head-title">
      <div class="left">
        <h1>Ajustes</h1>
        <ul class="breadcrumb">
          <li>
            <div>
              Config.
            </div>
          </li>
          <li>
            <svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg>
          </li>
          <li>
            <div class="active">
              Conta
            </div>
          </li>
        </ul>
      </div>
    </div>
    <!-- // final do título da página // -->
    <div class="container_user">
      <div class="profile">

      </div>
      <div class="container_info">
        <p class="name"></p>
        <p class="mail"></p>
      </div>
    </div>
    <div class="configuration_options">
      <p class="session_title">
        Preferências
      </p>
      <button id="dark_mode">
        <span>Modo claro</span><span><svg width="40" height="40" style="fill: var(--blue-ios) ; transform: rotate(180deg); enable-background:new 0 0 32 32;" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M23,8H9c-4.4,0-8,3.6-8,8s3.6,8,8,8h14c4.4,0,8-3.6,8-8S27.4,8,23,8z M9,21c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5  S11.8,21,9,21z" /></svg>
        </span>
      </button>
      <button style="display: none;" id="clear_mode">
        <span>Modo claro</span>
        <span><svg width="40" height="40" style="fill: var(--light); enable-background:new 0 0 32 32;" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M23,8H9c-4.4,0-8,3.6-8,8s3.6,8,8,8h14c4.4,0,8-3.6,8-8S27.4,8,23,8z M9,21c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5  S11.8,21,9,21z" /></svg></span>
      </button>
      <button>
        <span>Sobre</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
      <button id="privacy_policy">
        <span>Política de privacidade</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
      <button id="terms_of_use">
        <span>Termos de uso</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
      <button>
        <span>Segurança</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
      <button>
        <span>Feedback</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
      <button id="developer">
        <span>Desenvolvedor</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
      <button onclick="logout()" id="logout">
        <span>Sair</span>
        <span><svg style="margin-bottom:-3px;" height="20" viewBox="0 0 18 18" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M12.2197 6.03033C11.9268 5.73744 11.9268 5.26256 12.2197 4.96967C12.5126 4.67678 12.9874 4.67678 13.2803 4.96967L17.7803 9.46967C18.0732 9.76256 18.0732 10.2374 17.7803 10.5303L13.2803 15.0303C12.9874 15.3232 12.5126 15.3232 12.2197 15.0303C11.9268 14.7374 11.9268 14.2626 12.2197 13.9697L16.1893 10L12.2197 6.03033Z" /></svg></span>
      </button>
    </div>
  </section>
  <script src="./scripts/index.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.4.1/firebase-app.js"></script>
  <!-- Add additional services that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/5.4.1/firebase-firestore.js"></script>
  <!-- Inicializa o firebase -->
  <script src="https://www.gstatic.com/firebasejs/5.4.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/3.5.1/firebase-ui-auth__pt.js"></script>
  <script type="text/javascript" charset="utf-8">

    var config = {
      apiKey: "AIzaSyDZmkmi8qstIfuJ6il-uAfM8wqPFGNeQOI",
      authDomain: "playflix-os.firebaseapp.com",
      projectId: "playflix-os",
      storageBucket: "playflix-os.appspot.com",
      messagingSenderId: "974391976020",
      appId: "1:974391976020:web:f4d56ca28c548c452e0dc1",
      measurementId: "G-M1BGZ38TDV"
    };

    firebase.initializeApp(config);
    // Apenas para remover um warning
    firebase.firestore().settings({
      timestampsInSnapshots: true,

    });

    const db = firebase.firestore()
    const auth = firebase.auth()

    function logout() {
      // Faço um logout do meu usuário (saio da aplicação).
      firebase.auth().signOut().then(() => {
        alert('Usuário deslogou');
      })
    }

    /**
    * Listener de dom ready
    */
    /*
document.addEventListener("DOMContentLoaded", function () {
})
*/
    window.onload = function() {

      auth.onAuthStateChanged(user => {
        if (user) {
          var profile = document.querySelector("#imageUser");
          var hello = document.querySelector("#hello");

          profile.src = user.photoURL
          hello.innerHTML = "Olá " + user.displayName

          db.collection('users').doc(user.uid).onSnapshot((doc)=> {
            var body = document.querySelector("body");
            var style = document.createElement("div");
            style.innerHTML = `<style type="text/css" media="all">
            :root {

            --poppins: 'Raleway', sans-serif;
            --lato: 'Lato', sans-serif;

            --light: ${doc.data().light};
            --blue: ${doc.data().blue};
            --blue-ios: linear-gradient(-154.23deg, #0F3A7B -58.45%, rgb(12,17,255) 374.49%);
            --light-blue: #CFE8FF;
            --grey: ${doc.data().grey};
            --dark-grey: ${doc.data().darkGrey};
            --dark: ${doc.data().dark};
            --inverse-dark: ${doc.data().inverseDark};
            --red: #DB504A;
            --yellow: #FFCE26;
            --light-yellow: #FFF2C6;
            --orange: #FD7238;
            --light-orange: #FFE0D3;
            --white: #FFFFFF;
            --box-shadow: 0px 0px 15px #8383833e;
            --border-radius: 1.5em;
            }

            svg {
            fill: var(--dark);
            }

            </style>`;
            body.appendChild(style);

            if (doc.data().update == 'true') {
              document.querySelector("#update ").style.display = "none";
              document.querySelector("main").style.opacity = "1";
              document.querySelector("nav").style.opacity = "1";
            } else {
              document.querySelector("#update ").style.display = "block";
              document.querySelector("main").style.opacity = ".3";
              document.querySelector("nav").style.opacity = ".3";
            }


            return doc.data();
          });

          document.querySelector("#start_update").addEventListener("click",
            ()=> {
              var users = firebase.firestore().collection('users');

              users.doc(user.uid).set({
                name: user.displayName,
                photograph: user.photoURL,
                light: '#EFEFEF',
                blue: '#ffffff',
                grey: '#F9F9F9',
                darkGrey: '#000000',
                dark: '#000000',
                inverseDark: '#c5c5c5',
                update: 'true'
              });
            });


          var settings_profile = document.querySelector("#settings  .profile");
          var settings_name = document.querySelector("#settings .name");
          var settings_mail = document.querySelector("#settings .mail");

          settings_profile.innerHTML = `<img style="background: var(--light); width: 100%;" src="${user.photoURL}" />`;
          settings_name.innerHTML = user.displayName;
          settings_mail.innerHTML = user.email;
         


          // página de ajustes

          var clear_mode = document.querySelector("#clear_mode");
          var dark_mode = document.querySelector("#dark_mode");

          clear_mode.addEventListener("click",
            ()=> {
              clear_mode.style.display = "none";
              dark_mode.style.display = "flex";
              db.collection('users').doc(user.uid).update({
                light: '#EFEFEF',
                blue: '#ffffff',
                grey: '#F9F9F9',
                darkGrey: '##000000',
                dark: '#000000',
                inverseDark: '#c5c5c5'
              });
            });

          dark_mode.addEventListener("click",
            ()=> {
              dark_mode.style.display = "none";
              clear_mode.style.display = "flex";
              db.collection('users').doc(user.uid).update({
                light: '#3838387c',
                blue: '#000000',
                grey: '#000000',
                darkGrey: '#ffffff',
                dark: '#ffffff',
                inverseDark: '#f8f8f87f'
              });
            });

        } else {
          var provider = new firebase.auth.GoogleAuthProvider();

          firebase.auth().signInWithRedirect(provider).then(resposta => {
            if (resposta.credential) {
              const token = resposta.credential.accessToken;
            }
            const user = resposta.user;
          }).catch(error => {
            const errorCode = error.code;
            const errorMessage = error.message;
            const email = error.email;
            const credential = error.credential;
          });
        }
      });
    };

    if ("serviceWorker" in navigator) {
      window.addEventListener("load", function() {
        navigator.serviceWorker
        .register("serviceWorker.js")
        .then(res => console.log("service worker registered"))
        .catch(err => console.log("service worker not registered", err));
      });
    }
  </script>
</body>
</html>